<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DP Travels | Beyond Extraordinary Sikkim Journeys</title>

  <link rel="stylesheet" href="Style.css" />
  <link rel="icon" type="image/svg+xml"
    href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text x='50%' y='90%' font-size='80' font-family='Arial, sans-serif' text-anchor='middle' fill='%232dd4bf' font-weight='bold'>DP</text></svg>" />

  <!-- Bootstrap Grid for layout -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap-grid.min.css" rel="stylesheet" />
</head>

<body class="booking-page">
  <!-- Navbar Integration -->
  <nav id="mainNav" class="scrolled">
    <div class="container navbar">
      <a href="index.html" class="logo">
        <img src="Images/DP Travels.jpg" alt="DP Travels Logo" />
        DP TRAVELS
      </a>
      <ul class="nav-links">
        <li><a href="index.html#packages">DESTINATIONS</a></li>
        <li><a href="index.html#gallery">GALLERY</a></li>
        <li><a href="index.html#contact">CONTACT</a></li>
      </ul>
    </div>
  </nav>

  <div class="container" style="padding-top: 140px; padding-bottom: 80px;">
    <div class="row justify-content-center">
      <div class="col-lg-8 col-xl-7">
        <!-- Brand Header -->
        <div class="text-center mb-5 reveal active">
          <h1 class="display-3 fw-bold mb-3" style="letter-spacing: -2px;">Begin Your Journey</h1>
          <p class="text-muted fs-5">Fill in your details for a bespoke Himalayan itinerary.</p>
        </div>

        <!-- Sleek Form Card -->
        <div class="booking-container reveal active">
          <div class="booking-form-wrapper p-5">
            <form id="bookingForm">
              <div class="row">
                <div class="col-12 form-group">
                  <label class="form-label">Voyager Name</label>
                  <input type="text" class="form-control" name="name" placeholder="Full Name" required />
                </div>
              </div>

              <div class="row">
                <div class="col-md-6 form-group">
                  <label class="form-label">Email</label>
                  <input type="email" class="form-control" name="email" placeholder="email@address.com" required />
                </div>
                <div class="col-md-6 form-group">
                  <label class="form-label">Phone</label>
                  <input type="tel" class="form-control" name="phone" placeholder="+91" required />
                </div>
              </div>

              <div class="row">
                <div class="col-md-12 form-group">
                  <label class="form-label">Destination Odyssey</label>
                  <select class="form-control" id="destination" required>
                    <option value="">-- Choose your destination --</option>
                    <option value="Tsomo Lake">Sacred Tsomgo Lake</option>
                    <option value="Namchi">Namchi Spiritual Hub</option>
                    <option value="Guru Dongmar Lake">Guru Dongmar Odyssey</option>
                    <option value="Yumthang Valley">Yumthang Valley (North)</option>
                    <option value="Nathang Valley">Nathang Valley (East)</option>
                    <option value="Barsey Rhododendron">Barsey Sanctuary (West)</option>
                    <option value="Ravangla Buddha Park">Ravangla Buddha Park (South)</option>
                    <option value="Solophok Chardham">Solophok Chardham (Namchi)</option>
                    <option value="Samdruptse Hill">Samdruptse Hill (Namchi)</option>
                    <option value="Tarey Bhir">Tarey Bhir (Namchi)</option>
                    <option value="Goechala Pass Trek">Goechala Pass Trek (Trekking)</option>
                    <option value="Nathu La">Nathu La Border Pass</option>
                    <option value="Zuluk">Zuluk Silk Route</option>
                    <option value="Gangtok">Gangtok City Discovery</option>
                    <option value="Pelling">Pelling Sky Walk</option>
                  </select>
                </div>
              </div>

              <div class="row">
                <div class="col-md-12 form-group">
                  <label class="form-label">Excursion Vehicle</label>
                  <select class="form-control" id="cab" required disabled>
                    <option value="">Awaiting destination selection...</option>
                  </select>
                </div>
              </div>

              <div id="priceDisplay" class="price-box mb-4">
                Personalized pricing will appear here.
              </div>

              <div class="row">
                <div class="col-md-6 form-group">
                  <label class="form-label">Travellers</label>
                  <input type="number" class="form-control" name="travellers" min="1" value="1" required />
                </div>
                <div class="col-md-6 form-group">
                  <label class="form-label">Preferred Date</label>
                  <input type="date" class="form-control" id="bookingDate" name="bookingDate" required />
                </div>
              </div>

              <div class="form-group mb-5">
                <label class="form-label">Visions & Requests</label>
                <textarea class="form-control" name="message" rows="3"
                  placeholder="Any special needs for your journey?"></textarea>
              </div>

              <button type="submit" class="btn btn-primary btn-lg w-100 py-3 fw-bold"
                style="border-radius: 20px;">Confirm Booking</button>

              <div id="notification" class="mt-4 text-center fw-bold p-3" style="display: none; border-radius: 20px;">
              </div>
            </form>
          </div>
        </div>

        <div class="text-center mt-5">
          <p class="text-muted small">By initiating, you agree to our <a href="privacy.html"
              style="color: var(--accent); text-decoration: none;">premium service protocols</a>.</p>
        </div>
      </div>
    </div>
  </div>

  <script>
    const destinations = {
      "Tsomo Lake": { desc: "Access the sacred glacial mirror at 12,400 ft.", cabs: { "Elite SUV (Innova)": 12000, "Executive Sedan": 8000 } },
      "Namchi": { desc: "Spiritual immersion in the heart of South Sikkim.", cabs: { "Elite SUV (Innova)": 8000, "Executive Sedan": 5000 } },
      "Guru Dongmar Lake": { desc: "High-altitude odyssey to the frozen holy lake.", cabs: { "Elite SUV (Innova)": 28000, "Executive Sedan": 20000 } },
      "Yumthang Valley": { desc: "The Stunning Valley of Flowers in North Sikkim.", cabs: { "Elite SUV (Innova)": 18000, "Executive Sedan": 12000 } },
      "Nathang Valley": { desc: "The highest village in East Sikkim on the Silk Route.", cabs: { "Elite SUV (Innova)": 16000, "Executive Sedan": 10000 } },
      "Barsey Rhododendron": { desc: "A scarlet paradise in West Sikkim.", cabs: { "Elite SUV (Innova)": 12000, "Executive Sedan": 7000 } },
      "Ravangla Buddha Park": { desc: "South Sikkim's iconic spiritual landmark.", cabs: { "Elite SUV (Innova)": 9000, "Executive Sedan": 6000 } },
      "Solophok Chardham": { desc: "The spiritual heart of Namchi, featuring Char Dham replicas.", cabs: { "Elite SUV (Innova)": 7500, "Executive Sedan": 4500 } },
      "Samdruptse Hill": { desc: "The 'Wish Fulfilling Hill' with the golden Guru statue.", cabs: { "Elite SUV (Innova)": 7500, "Executive Sedan": 4500 } },
      "Tarey Bhir": { desc: "Panoramic cliff-edge adventure on the edge of the world.", cabs: { "Elite SUV (Innova)": 7500, "Executive Sedan": 4500 } },
      "Goechala Pass Trek": { desc: "Premium 11-day trek to the base of Kanchenjunga.", cabs: { "Guided Expedition Pack": 45000, "Luxury Camp Base": 35000 } },
      "Zuluk": { desc: "Traverse the historic Silk Route hairpin bends.", cabs: { "Elite SUV (Innova)": 15000, "Executive Sedan": 9000 } },
      "Nathu La": { desc: "Witness the historic Indo-China border pass.", cabs: { "Elite SUV (Innova)": 15000, "Executive Sedan": 9000 } },
      "Gangtok": { desc: "Curated capital city experience and sights.", cabs: { "Elite SUV (Innova)": 10000, "Executive Sedan": 8000 } },
      "Pelling": { desc: "Kanchenjunga views and the iconic Sky Walk.", cabs: { "Elite SUV (Innova)": 9000, "Executive Sedan": 6000 } }
    };

    const form = document.getElementById("bookingForm");
    const destinationSelect = document.getElementById("destination");
    const cabSelect = document.getElementById("cab");
    const priceDisplay = document.getElementById("priceDisplay");
    const bookingDateInput = document.getElementById("bookingDate");

    bookingDateInput.min = new Date().toISOString().split("T")[0];

    destinationSelect.addEventListener("change", () => {
      const dest = destinations[destinationSelect.value];
      cabSelect.innerHTML = '<option value="">-- Choose Cab --</option>';
      if (dest) {
        cabSelect.disabled = false;
        Object.entries(dest.cabs).forEach(([cab, price]) => {
          const opt = document.createElement("option");
          opt.value = cab;
          opt.textContent = `${cab} - Est. ₹${price.toLocaleString()}`;
          cabSelect.appendChild(opt);
        });
        priceDisplay.textContent = dest.desc;
        priceDisplay.style.color = "var(--text-muted)";
      } else {
        cabSelect.disabled = true;
        cabSelect.innerHTML = '<option value="">Awaiting Destination...</option>';
        priceDisplay.textContent = "Personalize your journey for pricing";
      }
    });

    cabSelect.addEventListener("change", () => {
      const dest = destinations[destinationSelect.value];
      const cab = cabSelect.value;
      if (dest && cab) {
        priceDisplay.innerHTML = `<span style="color: var(--accent);">✦ ESTIMATED VALUATION: ₹${dest.cabs[cab].toLocaleString()}</span>`;
      }
    });

    form.addEventListener("submit", async e => {
      e.preventDefault();
      const notification = document.getElementById("notification");
      const btn = e.target.querySelector("button");

      btn.disabled = true;
      btn.textContent = "CONFIRMING...";

      const formData = {
        name: form.name.value.trim(),
        email: form.email.value.trim(),
        phone: form.phone.value.trim(),
        destination: destinationSelect.value,
        cab: cabSelect.value,
        travellers: form.travellers.value.trim(),
        bookingDate: bookingDateInput.value,
        message: form.message.value.trim()
      };

      try {
        const res = await fetch("/send-booking", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(formData)
        });
        const result = await res.json();

        notification.style.display = "block";
        notification.style.background = result.success ? "rgba(45, 212, 191, 0.15)" : "rgba(239, 68, 68, 0.15)";
        notification.style.color = result.success ? "#2dd4bf" : "#ef4444";
        notification.textContent = result.message || result.error;

        if (result.success) {
          form.reset();
          setTimeout(() => window.location.href = "thankyou.html", 1500);
        }
      } catch (err) {
        notification.style.display = "block";
        notification.style.color = "#ef4444";
        notification.textContent = "Protocol error. Please retry.";
      } finally {
        btn.disabled = false;
        btn.textContent = "CONFIRM EXPEDITION";
      }
    });
  </script>
</body>

</html>